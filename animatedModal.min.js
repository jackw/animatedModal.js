!function(e,t){"function"==typeof define&&define.amd?define(t):e.AnimatedModal=t()}(this,function(){"use strict";function e(){var e,t=document.createElement("fakeelement"),o={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(e in o)if(void 0!==t.style[e])return o[e]}function t(e,t){var o=e.style,n,s;if(t=t.charAt(0).toUpperCase()+t.slice(1),void 0!==o[t])return t;for(s=0;s<d.length;s++)if(n=d[s]+t,void 0!==o[n])return n}function o(e,o){for(var n in o)e.style[t(e,n)||n]=o[n];return e}function n(e,t){return e.classList?e.classList.add(t):e.className+=" "+t,e}function s(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className),e}function i(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")}function a(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)void 0===e[n]&&(e[n]=o[n])}return e}function l(e){var t=this;t.opts=a(e||{},l.defaults,r),t.modal="object"==typeof t.opts.modalTarget?t.opts.modalTarget:document.getElementById(t.opts.modalTarget),t.isOpen=!1,t.opts.closeBtn&&t.modal.querySelector(t.opts.closeBtn).addEventListener("click",t.close.bind(t))}var d="webkit Moz ms O".split(" "),m=e(),r={animatedIn:"zoomIn",animatedOut:"zoomOut",closeBtn:".close-modal",modalBaseClass:"animated-modal",modalTarget:"animated-modal",opacityIn:"1",opacityOut:"0",visibilityIn:"visible",visibilityOut:"hidden",zIndexIn:"9999",zIndexOut:"-9999",afterClose:null,afterOpen:null,beforeClose:null,beforeOpen:null};return l.defaults={},l.prototype.open=function(){var e=this;if(!e.isOpen)return o(document.documentElement,{overflow:"hidden"}),o(document.body,{overflow:"hidden"}),s(e.modal,e.opts.modalBaseClass+"-off")&&(i(e.modal,e.opts.animatedOut),i(e.modal,e.opts.modalBaseClass+"-off"),n(e.modal,e.opts.modalBaseClass+"-on")),s(e.modal,e.opts.modalBaseClass+"-on")&&("function"==typeof e.opts.beforeOpen&&e.opts.beforeOpen(),o(e.modal,{opacity:e.opts.opacityIn,visibility:e.opts.visibilityIn,"z-index":e.opts.zIndexIn}),n(e.modal,this.opts.animatedIn),m?e.modal.addEventListener(m,function t(){"function"==typeof e.opts.afterOpen&&e.opts.afterOpen(),e.modal.removeEventListener(m,t),e.isOpen=!0,document.documentElement.addEventListener("keyup",function o(e){var t=e.keyCode||e.which;27===t&&(modal.close(modal),document.documentElement.removeEventListener("keyup",o))})}):("function"==typeof e.opts.afterOpen&&e.opts.afterOpen(),e.isOpen=!0,document.documentElement.addEventListener("keyup",function a(e){var t=e.keyCode||e.which;27===t&&(modal.close(modal),document.documentElement.removeEventListener("keyup",a))}))),e},l.prototype.close=function(){var e=this;if(e.isOpen)return document.documentElement.removeAttribute("style"),document.body.removeAttribute("style"),"function"==typeof e.opts.beforeClose&&e.opts.beforeClose(),s(e.modal,e.opts.modalBaseClass+"-on")&&(i(e.modal,e.opts.modalBaseClass+"-on"),n(e.modal,e.opts.modalBaseClass+"-off")),s(e.modal,e.opts.modalBaseClass+"-off")&&(i(e.modal,e.opts.animatedIn),n(e.modal,e.opts.animatedOut),m?e.modal.addEventListener(m,function t(){o(e.modal,{visibility:e.opts.visibilityOut,"z-index":e.opts.zIndexOut}),"function"==typeof e.opts.afterClose&&e.opts.afterClose(),e.isOpen=!1,e.modal.removeEventListener(m,t)}):(o(e.modal,{visibility:e.opts.visibilityOut,"z-index":e.opts.zIndexOut}),"function"==typeof e.opts.afterClose&&e.opts.afterClose(),e.isOpen=!1)),e},l});